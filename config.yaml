# TiDB fuzz configuration

# MySQL DSN, database part left empty to allow CREATE DATABASE
# Example: user:password@tcp(127.0.0.1:4000)/
dsn: root@tcp(127.0.0.1:4000)/
database: shiro_fuzz
seed: 1
iterations: 1000
workers: 1
plan_cache_only: false
max_tables: 5
max_join_tables: 4
max_columns: 8
max_rows_per_table: 50
max_data_dump_rows: 50
max_insert_statements: 200
statement_timeout_ms: 15000

plan_replayer:
  enabled: true
  # If the dump result does not include a full URL, this template is used.
  # Example: "http://127.0.0.1:10080/plan_replayer/dump/%s.zip"
  download_url_template: "http://127.0.0.1:10080/plan_replayer/dump/%s.zip"
  output_dir: reports
  timeout_seconds: 30
  max_download_bytes: 52428800

dqp:
  # Additional hint names; leave empty to use defaults.
  hint_sets: []
  # Session variables in form "var=value" to try with DQP.
  # Defaults apply if left empty (see config.go).
  variables: []

storage:
  s3:
    enabled: false
    endpoint: ""
    region: ""
    bucket: ""
    prefix: ""
    access_key_id: ""
    secret_access_key: ""
    session_token: ""
    use_path_style: false

features:
  joins: true
  cte: true
  subqueries: true
  aggregates: true
  group_by: true
  having: true
  order_by: true
  limit: true
  distinct: true
  plan_cache: true
  window_funcs: false
  correlated_subqueries: false
  views: true
  indexes: true
  foreign_keys: true
  check_constraints: true
  not_exists: true
  not_in: true

weights:
  actions:
    ddl: 1
    dml: 3
    query: 6
  dml:
    insert: 3
    update: 2
    delete: 1
  oracles:
    norec: 4
    tlp: 3
    dqp: 3
    cert: 2
    coddtest: 2
    dqe: 2
  features:
    join_count: 3
    cte_count: 2
    subquery_count: 3
    aggregate_prob: 40
    group_by_prob: 30
    having_prob: 20
    order_by_prob: 40
    limit_prob: 40
    distinct_prob: 20
    window_prob: 10
    not_exists_prob: 40
    not_in_prob: 40

logging:
  verbose: false
  report_interval_seconds: 30

oracles:
  # When true, TLP/CODDTest use simpler predicates to reduce false positives.
  strict_predicates: true

adaptive:
  enabled: false
  ucb_exploration: 1.5
  adapt_actions: false
  adapt_oracles: true
  adapt_dml: false
  adapt_features: false
